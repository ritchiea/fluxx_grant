- if current_user.has_view_for_model? ModelDocument
  - required_doc_ids ||= []
  - if model.respond_to?(:model_documents) && model.id
    -if current_user.is_portal_user?
      - portal_users = User.all_portal_users
      - partial_data_src_url = url_for(model_documents_path({:documentable_id => model.id, :documentable_type => model.class.name, :required_doc_ids => required_doc_ids, :restrict_by_users => portal_users, :skip_wrapper => true}))
      .partial{'data-src' => partial_data_src_url, 'class' => 'partial'}
        = render :partial => "model_documents/model_document_list", :locals => { :models => model.model_documents, :documentable => model, :required_doc_ids => required_doc_ids, :restrict_by_users => portal_users}
    -else
      - partial_data_src_url = url_for(model_documents_path({:documentable_id => model.id, :documentable_type => model.class.name, :required_doc_ids => required_doc_ids, :restrict_by_users => portal_users, :skip_wrapper => true}))
      .partial{'data-src' => partial_data_src_url, 'class' => 'partial'}
        = render :partial => "model_documents/model_document_list", :locals => { :models => model.model_documents, :documentable => model, :required_doc_ids => required_doc_ids}